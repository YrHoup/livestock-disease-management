{% extends 'base.html' %}

{% block title %}Predict Disease - Livestock Health Guardian{% endblock %}

{% block content %}
<div class="prediction-container">
    <h1>Animal Disease Prediction</h1>
    <p class="subtitle">Fill in the details below to get a health assessment for your animal</p>

    <div class="prediction-form-container">
        <form method="POST" action="/predict" class="prediction-form">
            <div class="form-group">
                <label for="AnimalName">Animal Type:</label>
                <select id="AnimalName" name="AnimalName" required>
                    <option value="">Select animal</option>
                    <option value="Horse">Horse</option>
                    <option value="Cow">Cow</option>
                    <option value="Sheep">Sheep</option>
                    <option value="Goat">Goat</option>
                    <option value="Pig">Pig</option>
                    <option value="Chicken">Chicken</option>
                    <option value="Duck">Duck</option>
                    <option value="Rabbit">Rabbit</option>
                    <option value="Dog">Dog</option>
                    <option value="Cat">Cat</option>
                </select>
            </div>

            <h3>Symptoms (Select up to 4 most prominent symptoms)</h3>
            <div class="symptoms-grid">
                {% set symptoms = [
                    'Fever', 'Lethargy', 'Appetite Loss', 'Vomiting', 'Diarrhea',
                    'Skin Lesions', 'Swelling', 'Coughing', 'Lameness', 'Labored Breathing',
                    'Dehydration', 'Eye Discharge', 'Nasal Discharge', 'Sneezing',
                    'Weight Loss', 'Decreased Milk Yield', 'Reduced Mobility'
                ] %}

                {% for i in range(1, 5) %}
                <div class="symptom-group">
                    <label for="symptoms{{i}}">Symptom {{i}}:</label>
                    <select id="symptoms{{i}}" name="symptoms{{i}}" required>
                        <option value="No">No symptom</option>
                        {% for symptom in symptoms %}
                        <option value="{{ symptom }}">{{ symptom }}</option>
                        {% endfor %}
                    </select>
                </div>
                {% endfor %}
            </div>

            <button type="submit" class="btn btn-primary">Predict Health Status</button>
        </form>
    </div>

    {% if prediction %}
    <div class="prediction-results">
        <h2>Prediction Results</h2>

        <div class="results-summary">
            <div class="input-summary">
                <h3>Animal Information:</h3>
                <p><strong>Type:</strong> {{ request.form.AnimalName }}</p>

                <h3>Symptoms Observed:</h3>
                <ul class="symptoms-list">
                    {% for i in range(1, 6) %}
                        {% if request.form['symptoms' + i|string] != 'No' %}
                            <li>{{ request.form['symptoms' + i|string] }}</li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>

            <div class="prediction-details">
                <div class="prediction-card {% if prediction == 'Yes' %}dangerous{% else %}safe{% endif %}">
                    <h3>Health Status:</h3>
                    <p class="prediction-value">
                        {% if prediction == 'Yes' %}
                            Dangerous (Needs Attention)
                        {% else %}
                            Healthy
                        {% endif %}
                    </p>
                    <div class="confidence-meter">
                        <div class="meter-bar" style="width: {{ probability }}%"></div>
                        <span>{{ probability }}% confidence</span>
                    </div>
                </div>

                <div class="advice-card">
                    <h3>Recommended Actions:</h3>
                    <p>{{ advice }}</p>
                    {% if prediction == 'Yes' %}
                        <p class="urgent">Please consult a veterinarian immediately.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    {% if error %}
    <div class="error-message">
        <p>{{ error }}</p>
    </div>
    {% endif %}
</div>
{% endblock %}